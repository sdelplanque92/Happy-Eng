(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,i=window.wp.components,l=window.ReactJSXRuntime;(0,e.registerBlockType)("he/tiles",{edit:({attributes:e,setAttributes:r})=>{const{heading:n,paragraph:a}=e,s=Array.isArray(e.items)?e.items:[{url:"",icon:"",title:"",text:""}],o=(0,t.useBlockProps)({className:"he-tiles-editor"}),c=(e,t)=>{const i=s.map((i,l)=>l===e?{...i,...t}:i);r({items:i})};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.InspectorControls,{children:(0,l.jsxs)(i.PanelBody,{title:"Tiles",children:[(0,l.jsx)(i.Button,{variant:"primary",onClick:()=>r({items:[...s,{url:"",icon:"",title:"",text:""}]}),children:"+ Ajouter une tuile"}),(0,l.jsx)("div",{style:{marginTop:12},children:s.map((e,t)=>(0,l.jsxs)("div",{style:{borderTop:t?"1px solid #ddd":"none",paddingTop:t?12:0,marginTop:t?12:0},children:[(0,l.jsx)(i.TextControl,{label:`Tuile ${t+1} — Lien (URL)`,value:e.url||"",onChange:e=>c(t,{url:e}),placeholder:"/page/ ou https://…"}),(0,l.jsx)(i.TextControl,{label:`Tuile ${t+1} — Icon (nom machine)`,value:e.icon||"",onChange:e=>c(t,{icon:e}),placeholder:"server, cloud, cpu…",help:"Applique une classe (ex: he-icon--server)."}),(0,l.jsx)(i.TextControl,{label:`Tuile ${t+1} — Titre`,value:e.title||"",onChange:e=>c(t,{title:e})}),(0,l.jsx)(i.TextareaControl,{label:`Tuile ${t+1} — Texte`,value:e.text||"",onChange:e=>c(t,{text:e})}),(0,l.jsx)(i.Button,{variant:"secondary",onClick:()=>(e=>{const t=s.filter((t,i)=>i!==e);r({items:t.length?t:[{url:"",icon:"",title:"",text:""}]})})(t),children:"Supprimer cette tuile"})]},t))})]})}),(0,l.jsx)("section",{...o,children:(0,l.jsxs)("div",{className:"he-tiles__container",children:[(0,l.jsx)(t.RichText,{tagName:"h2",className:"he-tiles__title",placeholder:"Titre…",value:n,onChange:e=>r({heading:e}),allowedFormats:[]}),(0,l.jsx)(t.RichText,{tagName:"p",className:"he-tiles__paragraph",placeholder:"Paragraphe… (Entrée = retour à la ligne)",value:a,onChange:e=>r({paragraph:e}),allowedFormats:["core/bold","core/italic","core/link"]}),(0,l.jsx)("div",{className:"he-tiles__grid",children:s.map((e,t)=>(0,l.jsxs)("div",{className:"he-tile",style:{padding:16,border:"1px solid #ddd",borderRadius:12},children:[(0,l.jsxs)("div",{style:{fontSize:12,opacity:.7},children:["icon: ",(0,l.jsx)("code",{children:e.icon||"—"})]}),(0,l.jsx)("div",{style:{fontWeight:700,marginTop:6},children:e.title||"Titre…"}),(0,l.jsx)("div",{style:{marginTop:6,opacity:.9},children:e.text||"Texte…"}),(0,l.jsx)("div",{style:{marginTop:10,fontSize:12,opacity:.7},children:e.url?`→ ${e.url}`:"URL manquante"})]},t))})]})})]})},save:()=>null})})();