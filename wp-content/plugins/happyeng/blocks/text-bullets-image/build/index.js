(()=>{"use strict";const e=window.wp.blocks,t=window.wp.blockEditor,i=window.wp.components,l=window.ReactJSXRuntime;(0,e.registerBlockType)("he/text-bullets-image",{edit:({attributes:e,setAttributes:a})=>{const{title:n,text:s,mediaId:r,mediaUrl:o,mediaAlt:d}=e,c=Array.isArray(e.items)?e.items:[{text:""}],m=(0,t.useBlockProps)({className:"he-tbi-editor"});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(t.InspectorControls,{children:[(0,l.jsxs)(i.PanelBody,{title:"Image",children:[(0,l.jsx)(i.TextControl,{label:"Texte alternatif (alt)",value:d,onChange:e=>a({mediaAlt:e}),help:"Accessibilité & SEO."}),o?(0,l.jsx)(i.Button,{variant:"secondary",onClick:()=>a({mediaId:0,mediaUrl:"",mediaAlt:""}),children:"Retirer l’image"}):null]}),(0,l.jsxs)(i.PanelBody,{title:"Liste à puces",initialOpen:!1,children:[(0,l.jsx)(i.Button,{variant:"primary",onClick:()=>a({items:[...c,{text:""}]}),children:"+ Ajouter un point"}),(0,l.jsx)("div",{style:{marginTop:12},children:c.map((e,n)=>(0,l.jsxs)("div",{style:{borderTop:n?"1px solid #ddd":"none",paddingTop:n?12:0,marginTop:n?12:0},children:[(0,l.jsx)(t.RichText,{tagName:"p",placeholder:`Point ${n+1}… (Entrée = retour à la ligne)`,value:e.text,onChange:e=>((e,t)=>{const i=c.map((i,l)=>l===e?{...i,text:t}:i);a({items:i})})(n,e),allowedFormats:["core/bold","core/italic","core/link"]}),(0,l.jsx)(i.Button,{variant:"secondary",onClick:()=>(e=>{const t=c.filter((t,i)=>i!==e);a({items:t.length?t:[{text:""}]})})(n),children:"Supprimer ce point"})]},n))})]})]}),(0,l.jsx)("section",{...m,children:(0,l.jsxs)("div",{className:"he-tbi__container",children:[(0,l.jsx)(t.RichText,{tagName:"h2",className:"he-tbi__title",placeholder:"Titre…",value:n,onChange:e=>a({title:e}),allowedFormats:[]}),(0,l.jsx)(t.RichText,{tagName:"p",className:"he-tbi__text",placeholder:"Texte… (Entrée = retour à la ligne)",value:s,onChange:e=>a({text:e}),allowedFormats:["core/bold","core/italic","core/link"]}),(0,l.jsxs)("div",{className:"he-tbi__row",children:[(0,l.jsx)("div",{className:"he-tbi__left",children:(0,l.jsx)(t.InnerBlocks,{allowedBlocks:["he/bullet-list"],template:[["he/bullet-list"]],templateLock:"all"})}),(0,l.jsx)("div",{className:"he-tbi__right",children:(0,l.jsx)(t.MediaUploadCheck,{children:(0,l.jsx)(t.MediaUpload,{onSelect:e=>{a({mediaId:e?.id||0,mediaUrl:e?.url||"",mediaAlt:e?.alt||""})},allowedTypes:["image"],value:r,render:({open:e})=>(0,l.jsx)("div",{children:o?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",{className:"he-tbi__img",src:o,alt:d||""}),(0,l.jsx)("div",{style:{marginTop:8},children:(0,l.jsx)(i.Button,{variant:"primary",onClick:e,children:"Changer l’image"})})]}):(0,l.jsx)(i.Button,{variant:"primary",onClick:e,children:"Choisir une image"})})})})})]})]})})]})},save:()=>(0,l.jsx)(t.InnerBlocks.Content,{})})})();